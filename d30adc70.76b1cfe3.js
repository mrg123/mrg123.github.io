(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{130:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return p})),n.d(t,"metadata",(function(){return r})),n.d(t,"rightToc",(function(){return b})),n.d(t,"default",(function(){return o}));var c=n(2),a=n(6),l=(n(0),n(139)),p={id:"CLOSE_WAIT\u6848\u4f8b",title:"\u8bb0\u5f55\u4e00\u6b21CLOSE_WAIT\u6848\u4f8b"},r={id:"CLOSE_WAIT\u6848\u4f8b",title:"\u8bb0\u5f55\u4e00\u6b21CLOSE_WAIT\u6848\u4f8b",description:"\u73b0\u6709\u7684\u7cfb\u7edf\u67b6\u6784\u57fa\u4e8enginx \u7f51\u7ba1\u53cd\u5411\u4ee3\u7406 +  web\u670d\u52a1\u5668\u4f7f\u7528apache + php + mysql \u963f\u91cc\u4e91RDS",source:"@site/docs\\close-wait\u6848\u4f8b.md",permalink:"/docs/CLOSE_WAIT\u6848\u4f8b",editUrl:"https://github.com/mrg123/mrg123.github.io/edit/master/my-website/docs\\close-wait\u6848\u4f8b.md",sidebar:"someSidebar",previous:{title:"\u547d\u4ee4\u884c\u7ec8\u7aef\u8bbe\u7f6e\u4ee3\u7406 windows / mac / linux",permalink:"/docs/\u547d\u4ee4\u884c\u7ec8\u7aef\u8bbe\u7f6e\u4ee3\u7406"},next:{title:"\u5982\u4f55\u5206\u6790\u95ee\u9898?\u5982\u4f55\u806a\u660e\u7684\u63d0\u95ee",permalink:"/docs/\u7cbe\u51c6\u5b9a\u4f4d\u95ee\u9898"}},b=[{value:"\u95ee\u9898",id:"\u95ee\u9898",children:[]},{value:"\u89e3\u51b3\u65b9\u6848",id:"\u89e3\u51b3\u65b9\u6848",children:[]},{value:"\u4e34\u65f6\u7684\u89e3\u51b3\u65b9\u6848",id:"\u4e34\u65f6\u7684\u89e3\u51b3\u65b9\u6848",children:[]},{value:"\u67e5\u770b\u670d\u52a1\u5668\u5f53\u524dTCP CLOSE_WAIT\u72b6\u6001\u7684\u8fdb\u7a0b",id:"\u67e5\u770b\u670d\u52a1\u5668\u5f53\u524dtcp-close_wait\u72b6\u6001\u7684\u8fdb\u7a0b",children:[]},{value:"\u4f7f\u7528tcpdump\u547d\u4ee4\u5bfc\u51fa\u8bf7\u6c42\u65e5\u5fd7",id:"\u4f7f\u7528tcpdump\u547d\u4ee4\u5bfc\u51fa\u8bf7\u6c42\u65e5\u5fd7",children:[]},{value:"tcp\u8fdb\u7a0b\u6c60\u6ee1\u4e86apache\u9519\u8bef\u65e5\u5fd7",id:"tcp\u8fdb\u7a0b\u6c60\u6ee1\u4e86apache\u9519\u8bef\u65e5\u5fd7",children:[]},{value:"CLOSE_WAIT\u6545\u969c\u5206\u6790",id:"close_wait\u6545\u969c\u5206\u6790",children:[]},{value:"TCP\u4e09\u6b21\u63e1\u624b",id:"tcp\u4e09\u6b21\u63e1\u624b",children:[]},{value:"TCP\u56db\u6b21\u6325\u624b",id:"tcp\u56db\u6b21\u6325\u624b",children:[]},{value:"TCP\u901a\u4fe1\u6570\u636e\u5305\u5206\u6790",id:"tcp\u901a\u4fe1\u6570\u636e\u5305\u5206\u6790",children:[]},{value:"CLOSE_WAIT TCP\u5305\u901a\u4fe1\u8bf7\u6c42\u5206\u6790",id:"close_wait-tcp\u5305\u901a\u4fe1\u8bf7\u6c42\u5206\u6790",children:[]},{value:"xmind\u601d\u7ef4\u5bfc\u56fe\u9644\u4ef6\u4e0b\u8f7d",id:"xmind\u601d\u7ef4\u5bfc\u56fe\u9644\u4ef6\u4e0b\u8f7d",children:[]}],i={rightToc:b};function o(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(l.b)("wrapper",Object(c.a)({},i,n,{components:t,mdxType:"MDXLayout"}),Object(l.b)("p",null,"\u73b0\u6709\u7684\u7cfb\u7edf\u67b6\u6784\u57fa\u4e8enginx \u7f51\u7ba1\u53cd\u5411\u4ee3\u7406 +  web\u670d\u52a1\u5668\u4f7f\u7528apache + php + mysql \u963f\u91cc\u4e91RDS"),Object(l.b)("p",null,"\u73b0\u6709\u65b9\u6848\u8003\u8651\u66f4\u6362\u6210 nginx \u7f51\u7ba1\u53cd\u5411\u4ee3\u7406 + web\u670d\u52a1\u5668 nginx + php-fpm +php + mysql  \u963f\u91cc\u4e91RDS"),Object(l.b)("p",null,"PHP 7.0\u7248\u672c apache 2.4\u7248\u672c"),Object(l.b)("h2",{id:"\u95ee\u9898"},"\u95ee\u9898"),Object(l.b)("ol",null,Object(l.b)("li",{parentName:"ol"},"\u53d1\u5e03\u4ee3\u7801\u53ef\u80fd\u5bfc\u81f4\u7cfb\u7edf\u51fa\u73b0502"),Object(l.b)("li",{parentName:"ol"},"owms,hms\u8bf7\u6c42wms\u670d\u52a1\u5668,\u4f1a\u51fa\u73b0\u5927\u91cf\u7684CLOSE_WAIT\u72b6\u6001\u7684tcp\u8bf7\u6c42,\u8bf7\u6c42\u91cf\u5927\u7684\u60c5\u51b5\u4e0b,\u4f1a\u5bfc\u81f4\u8fde\u63a5\u6c60\u5360\u6ee1,\u65e0\u6cd5\u5904\u7406\u8bf7\u6c42,\u670d\u52a1\u5668\u51fa\u73b0502"),Object(l.b)("li",{parentName:"ol"},"\u8bf7\u6c42owms\u670d\u52a1\u5668,\u6709\u6982\u7387\u51fa\u73b0502"),Object(l.b)("li",{parentName:"ol"},"apache\u5b58\u5728\u9519\u8bef,\u8fdb\u7a0b\u5f02\u5e38\u9000\u51fa,php\u6a21\u5757\u5f02\u5e38,\u5185\u5b58\u6cc4\u6f0f\u7b49\u95ee\u9898"),Object(l.b)("li",{parentName:"ol"},"\u5927\u91cf\u7684CLOSE_WAIT\u4e00\u5b9a\u65f6\u5e94\u7528\u7a0b\u5e8f\u51fa\u73b0\u95ee\u9898,\u5982\u679c\u662fjava\u6216\u8005.net\u8bed\u8a00\u7684\u5e94\u7528\u53ef\u4ee5\u8003\u8651\u662f\u5426socks\u672a\u6b63\u5e38\u5173\u95ed\u5bfc\u81f4\u7684\u95ee\u9898")),Object(l.b)("p",null,"\u95ee\u98981 - \u53d1\u5e03\u51fa\u73b0502"),Object(l.b)("p",null,Object(l.b)("img",Object(c.a)({parentName:"p"},{src:"../static/img/502_1.jpg",alt:"502_1"}))," "),Object(l.b)("p",null,"\u95ee\u98982 - \u5927\u91cf\u8bf7\u6c42502  - grafana \u5206\u6790web\u670d\u52a1\u5668\u7684\u6027\u80fd\u65e5\u5fd7\u5927\u91cfCLOSE_WAIT tcp\u8fdb\u7a0b,\u5360\u7528\u94fe\u63a5\u6c60"),Object(l.b)("p",null,Object(l.b)("img",Object(c.a)({parentName:"p"},{src:"../static/img/502_2.png",alt:"502_2"}))),Object(l.b)("p",null,"\u95ee\u98983 - \u8bf7\u6c42\u968f\u673a502 - kibana\u5206\u6790apache\u8bbf\u95ee\u65e5\u5fd7,\u968f\u673a502"),Object(l.b)("p",null,Object(l.b)("img",Object(c.a)({parentName:"p"},{src:"../static/img/502_3.png",alt:"502_3"}))),Object(l.b)("p",null,"\u95ee\u98984 -  apache\u9519\u8bef\u65e5\u5fd7"),Object(l.b)("p",null,Object(l.b)("img",Object(c.a)({parentName:"p"},{src:"../static/img/502_4.png",alt:"502_4"}))),Object(l.b)("h2",{id:"\u89e3\u51b3\u65b9\u6848"},"\u89e3\u51b3\u65b9\u6848"),Object(l.b)("p",null,"1 \u505c\u7528apache,\u4f7f\u7528php-fpm\u66ff\u6362"),Object(l.b)("p",null,"2 PHP\u7a0b\u5e8f\u4f7f\u7528\u7684curl,\u6709close,\u6392\u67e5\u5e94\u7528\u95ee\u9898,\u53ef\u80fd\u65f6apache\u5e95\u5c42\u95ee\u9898\u6216\u8005PHP\u63d2\u4ef6\u95ee\u9898"),Object(l.b)("p",null,"\u7406\u7531,FPM\u66f4\u7a33\u5b9a,\u652f\u6301\u66f4\u5927\u7684\u8bf7\u6c42"),Object(l.b)("h2",{id:"\u4e34\u65f6\u7684\u89e3\u51b3\u65b9\u6848"},"\u4e34\u65f6\u7684\u89e3\u51b3\u65b9\u6848"),Object(l.b)("ol",null,Object(l.b)("li",{parentName:"ol"},"\u8bbe\u7f6eMaxRequestWorkers =1000 \u8fd9\u4e2a\u53ea\u662f\u5ef6\u8fdf\u4e86\u4e8b\u6545\u53d1\u751f,\u5982\u679c\u670d\u52a1\u5668\u518d\u6b21\u8017\u5c3d\u5185\u5b58,\u95ee\u9898\u4f9d\u65e7\u4f1a\u53d1\u751f"),Object(l.b)("li",{parentName:"ol"},"\u5982\u679c\u8bf7\u6c42\u91cf\u4e0d\u591a,\u53ef\u4ee5\u5207\u6362apache\u7684\u5de5\u4f5c\u6a21\u5f0f,\u770b\u80fd\u5426\u89e3\u51b3,\u4fee\u6539apache\u5de5\u4f5c\u6a21\u5f0f \u5207\u6362\u5230 prefork  "),Object(l.b)("li",{parentName:"ol"},"http\u8bf7\u6c42\u7684\u5934\u90e8\u8bbe\u7f6e ''Connection'  => 'close'")),Object(l.b)("h2",{id:"\u67e5\u770b\u670d\u52a1\u5668\u5f53\u524dtcp-close_wait\u72b6\u6001\u7684\u8fdb\u7a0b"},"\u67e5\u770b\u670d\u52a1\u5668\u5f53\u524dTCP CLOSE_WAIT\u72b6\u6001\u7684\u8fdb\u7a0b"),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{}),"netstat -antp | grep CLOSE_WAIT\n")),Object(l.b)("p",null,"\u968f\u673a\u7aef\u53e3\u7684\u670d\u52a1\u5668\u4e3a\u5ba2\u6237\u7aef,\u53e6\u4e00\u4e2a\u670d\u52a1\u5668\u4e3a\u670d\u52a1\u7aef"),Object(l.b)("p",null,Object(l.b)("img",Object(c.a)({parentName:"p"},{src:"../static/img/close-wait01.png",alt:"close-wait01"}))),Object(l.b)("h2",{id:"\u4f7f\u7528tcpdump\u547d\u4ee4\u5bfc\u51fa\u8bf7\u6c42\u65e5\u5fd7"},"\u4f7f\u7528tcpdump\u547d\u4ee4\u5bfc\u51fa\u8bf7\u6c42\u65e5\u5fd7"),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{}),"tcpdump  -w   /path/log.cap\n")),Object(l.b)("p",null,"\u5bfc\u51fa\u6587\u4ef6\u540e,\u53ef\u4ee5\u4e0b\u8f7d\u8f6f\u4ef6wireshark\u5206\u6790tcp\u8bf7\u6c42\u65e5\u5fd7"),Object(l.b)("h2",{id:"tcp\u8fdb\u7a0b\u6c60\u6ee1\u4e86apache\u9519\u8bef\u65e5\u5fd7"},"tcp\u8fdb\u7a0b\u6c60\u6ee1\u4e86apache\u9519\u8bef\u65e5\u5fd7"),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{}),"[Sat May 16 04:16:51.913919 2020] [mpm_event:error] [pid 24619:tid 140552500967168] AH03490: scoreboard is full, not at MaxRequestWorkers.Increase ServerLimit.\n")),Object(l.b)("p",null,"\u56e0\u4e3aCLOSE_WAIT\u592a\u591a,\u5bfc\u81f4tcp\u8fdb\u7a0b\u6c60\u6ee1\u4e86,\u670d\u52a1\u7aef\u65e0\u6cd5\u518d\u670d\u52a1"),Object(l.b)("h2",{id:"close_wait\u6545\u969c\u5206\u6790"},"CLOSE_WAIT\u6545\u969c\u5206\u6790"),Object(l.b)("p",null,"\u5ba2\u6237\u7aef\u53d1\u8d77\u7684\u6325\u624b\u8bf7\u6c42,\u670d\u52a1\u7aef\u8fd4\u56de\u786e\u8ba4\u540e,\u8fdb\u5165CLOST_WAIT\u4f46\u662f\u5e94\u7528\u5173\u95ed\u5931\u8d25,\u7b2c\u4e09\u6b21\u6325\u624b\u8bf7\u6c42\u6ca1\u6709\u53d1\u9001\u51fa\u53bb\u5bfc\u81f4\u8fdb\u7a0b\u505c\u7559\u5728CLOST_WAIT\u72b6\u6001,\u5ba2\u6237\u7aefTCP\u505c\u7559\u5728FIN-WAIT-2\u72b6\u6001,\u56e0\u4e3a Linux \u6709\u4e00\u4e2a\u300ctcp_fin_timeout\u300d\u8bbe\u7f6e,\u63a7\u5236\u4e86 FIN_WAIT2 \u7684\u6700\u5927\u751f\u547d\u5468\u671f.\u6240\u4ee5\u5ba2\u6237\u7aef\u4e0d\u4f1a\u51fa\u73b0\u963b\u585e\u60c5\u51b5"),Object(l.b)("h2",{id:"tcp\u4e09\u6b21\u63e1\u624b"},"TCP\u4e09\u6b21\u63e1\u624b"),Object(l.b)("p",null,Object(l.b)("img",Object(c.a)({parentName:"p"},{src:"../static/img/TCP-%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B.jpg",alt:"TCP-\u56db\u6b21\u6325\u624b"}))),Object(l.b)("p",null,Object(l.b)("em",{parentName:"p"},"\u63e1\u624b\u8bf7\u6c42\u53d1\u8d77\u65b9\u4e00\u5b9a\u662f\u5ba2\u6237\u7aef")),Object(l.b)("h2",{id:"tcp\u56db\u6b21\u6325\u624b"},"TCP\u56db\u6b21\u6325\u624b"),Object(l.b)("p",null,Object(l.b)("img",Object(c.a)({parentName:"p"},{src:"../static/img/TCP-%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B.jpg",alt:"TCP-\u56db\u6b21\u6325\u624b"}))),Object(l.b)("p",null,Object(l.b)("em",{parentName:"p"},"\u6325\u624b\u8bf7\u6c42\u53ef\u4ee5\u662f\u5ba2\u6237\u7aef\u53d1\u8d77\u4e5f\u53ef\u4ee5\u662f\u670d\u52a1\u7aef\u53d1\u8d77")),Object(l.b)("p",null,Object(l.b)("em",{parentName:"p"},"\u5ba2\u6237\u7aef\u8bf7\u6c42\u5934\u90e8\u8bbe\u7f6e''Connection'  => 'close' \u540e,\u4e5f\u4f1a\u4e3b\u52a8\u53d1\u8d77\u6325\u624b,\u4f46\u662f\u670d\u52a1\u7aef\u4e0d\u4e00\u5b9a\u4f1a\u786e\u8ba4,\u4e5f\u53ef\u4ee5\u518d\u6b21\u53d1\u8d77\u6325\u624b\u5230\u5ba2\u6237\u7aef")),Object(l.b)("h2",{id:"tcp\u901a\u4fe1\u6570\u636e\u5305\u5206\u6790"},"TCP\u901a\u4fe1\u6570\u636e\u5305\u5206\u6790"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},"114:12:45.104687  \u65f6\u95f4\u5e26\u6709\u7cbe\u786e\u5230\u5fae\u5999"),Object(l.b)("li",{parentName:"ul"},"localhost.39870 > localhost.9502 \u8868\u793a\u901a\u4fe1\u7684\u6d41\u5411\uff0c39870\u662f\u5ba2\u6237\u7aef\u7684\u968f\u673a\u63a5\u53e3\uff0c9502\u662f\u670d\u52a1\u5668\u7aef,\u56fa\u5b9a\u7aef\u53e3"),Object(l.b)("li",{parentName:"ul"},"[S]"," \u8868\u793a\u8fd9\u662f\u4e00\u4e2aSYN\u8bf7\u6c42"),Object(l.b)("li",{parentName:"ul"},"[S.]"," \u8868\u793a\u8fd9\u662f\u4e00\u4e2aSYN+ACK\u786e\u8ba4\u5305: "),Object(l.b)("li",{parentName:"ul"},"[.]"," \u8868\u793a\u8fd9\u662f\u4e00\u4e2aACT\u786e\u8ba4\u5305\uff0c (client)SYN->(server)SYN->(client)ACT \u5c31\u662f3\u6b21\u63e1\u624b\u8fc7\u7a0b"),Object(l.b)("li",{parentName:"ul"},"[P]"," \u8868\u793a\u8fd9\u4e2a\u662f\u4e00\u4e2a\u6570\u636e\u63a8\u9001\uff0c\u53ef\u4ee5\u662f\u4ece\u670d\u52a1\u5668\u7aef\u5411\u5ba2\u6237\u7aef\u63a8\u9001\uff0c\u4e5f\u53ef\u4ee5\u4ece\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u5668\u7aef\u63a8"),Object(l.b)("li",{parentName:"ul"},"[F]"," \u8868\u793a\u8fd9\u662f\u4e00\u4e2aFIN\u5305\uff0c\u662f\u5173\u95ed\u8fde\u63a5\u64cd\u4f5c\uff0cclient/server\u90fd\u6709\u53ef\u80fd\u53d1\u8d77"),Object(l.b)("li",{parentName:"ul"},"[R]"," \u8868\u793a\u8fd9\u662f\u4e00\u4e2aRST\u5305\uff0c\u4e0eF\u5305\u4f5c\u7528\u76f8\u540c\uff0c\u4f46RST\u8868\u793a\u8fde\u63a5\u5173\u95ed\u65f6\uff0c\u4ecd\u7136\u6709\u6570\u636e\u672a\u88ab\u5904\u7406\u3002\u53ef\u4ee5\u7406\u89e3\u4e3a\u662f\u5f3a\u5236\u5207\u65ad"),Object(l.b)("li",{parentName:"ul"},"win 4099 \u662f\u6307\u6ed1\u52a8\u7a97\u53e3\u5927\u5c0f"),Object(l.b)("li",{parentName:"ul"},"length 18\u6307\u6570\u636e\u5305\u7684\u5927\u5c0f")),Object(l.b)("p",null,"1 \u5ba2\u6237\u7aef49492 \u670d\u52a1\u7aef60081\n\u5ba2\u6237\u7aef\u53d1\u8d77\u8bf7\u6c42 \u7b2c\u4e00\u6b21\u63e1\u624b ","[S]","  SYN = 1, seq = 2396311514"),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{}),"13:34:18.895072 IP 10.10.10.10.49492 > 10.10.10.159.600: Flags [S], seq 2396311514, win 29200, options [mss 1460,sackOK,TS val 429550635 ecr 0,nop,wscale 7], length 0\n")),Object(l.b)("p",null,"2 \u670d\u52a1\u7aef\u786e\u8ba4 \u7b2c\u4e8c\u6b21\u63e1\u624b  ","[S.]","  SYN=1,ACK=1, ack = 2396311514+1 ,seq = 2480093606, "),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{}),"13:34:19.042847 IP 10.10.10.159.600 > 10.10.10.10.49492: Flags [S.], seq 2480093606, ack 2396311515, win 28960, options [mss 1460,sackOK,TS val 500389019 ecr 429550635,nop,wscale 7], length 0\n")),Object(l.b)("p",null,"3 \u5ba2\u6237\u7aef\u786e\u8ba4 \u7b2c\u4e09\u6b21\u63e1\u624b ","[.]"," ACK=1, ack=1 | \u5ba2\u6237\u7aef\u6536\u5230\u4e86\u670d\u52a1\u7aef\u7684SYN+ACK\u5305,\u5411\u670d\u52a1\u7aef\u53d1\u9001\u786e\u8ba4\u5305ACK(ack=2480093606+1)"),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{}),"13:34:19.042858 IP 10.10.10.10.49492 > 10.10.10.159.600: Flags [.], ack 1, win 229, options [nop,nop,TS val 429550672 ecr 500389019], length 0\n")),Object(l.b)("p",null,"\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u8fdb\u5165 ESTABLISHED \u72b6\u6001,\u8fdb\u884c\u6570\u636e\u7684\u53cc\u5411\u901a\u4fe1"),Object(l.b)("p",null,"4 \u5ba2\u6237\u7aef\u53d1\u9001\u6570\u636e\u5305 ","[P.]"," 702\u5b57\u8282\u957f\u5ea6\u7684\u6570\u636e "),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{}),"13:34:19.042888 IP 10.10.10.10.49492 > 10.10.10.159.600: Flags [P.], seq 1:703, ack 1, win 229, options [nop,nop,TS val 429550672 ecr 500389019], length 702\n")),Object(l.b)("p",null,"5 \u5ba2\u6237\u7aef\u518d\u6b21\u53d1\u9001\u6570\u636e\u5305 ","[P.]","  702\u5b57\u8282\u957f\u5ea6\u7684\u6570\u636e "),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{}),"13:34:19.461644 IP 10.10.10.10.49492 > 10.10.10.159.600: Flags [P.], seq 1:703, ack 1, win 229, options [nop,nop,TS val 429550777 ecr 500389019], length 702\n")),Object(l.b)("p",null,"6 \u670d\u52a1\u7aef\u786e\u8ba4\u6536\u5230\u6570\u636e "),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{}),"13:34:19.609433 IP 10.10.10.159.600 > 10.10.10.10.49492: Flags [.], ack 703, win 238, options [nop,nop,TS val 500389161 ecr 429550777], length 0\n")),Object(l.b)("p",null,"7 \u670d\u52a1\u7aef\u53d1\u9001\u6570\u636e\u5305 ","[P.]"," 1056\u5b57\u8282\u957f\u5ea6\u7684\u6570\u636e"),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{}),"13:34:19.625753 IP 10.10.10.159.600 > 10.10.10.10.49492: Flags [P.], seq 1:1057, ack 703, win 238, options [nop,nop,TS val 500389165 ecr 429550777], length 1056\n")),Object(l.b)("p",null,"8 \u5ba2\u6237\u7aef\u786e\u8ba4\u6536\u5230\u6570\u636e"),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{}),"13:34:19.625760 IP 10.10.10.10.49492 > 10.10.10.159.600: Flags [.], ack 1057, win 245, options [nop,nop,TS val 429550818 ecr 500389165], length 0\n")),Object(l.b)("p",null,"9  \u670d\u52a1\u7aef\u518d\u6b21\u53d1\u9001\u6570\u636e 1056\u5b57\u8282\u957f\u5ea6\u7684\u6570\u636e"),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{}),"13:34:20.764275 IP 10.10.10.159.600 > 10.10.10.10.49492: Flags [P.], seq 1:1057, ack 703, win 238, options [nop,nop,TS val 500389450 ecr 429550777], length 1056\n")),Object(l.b)("p",null,"10 \u5ba2\u6237\u7aef\u8868\u793a\u6536\u5230\u6570\u636e"),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{}),"13:34:20.764281 IP 10.10.10.10.49492 > 10.10.10.159.600: Flags [.], ack 1057, win 245, options [nop,nop,TS val 429551102 ecr 500389450,nop,nop,sack 1 {1:1057}], length 0\n")),Object(l.b)("p",null,"\u4ee5\u4e0a\u662f\u63e1\u624b\u8bf7\u6c42\u548c\u6570\u636e\u4f20\u8f93\u7684tcp\u5305\u901a\u4fe1\u8bb0\u5f55,\u63a5\u4e0b\u6765\u8fd8\u6709\u56db\u6b21\u6325\u624b\u8bb0\u5f55,\u624d\u80fd\u5b8c\u6210\u6574\u4e2aTCP\u8bf7\u6c42"),Object(l.b)("h2",{id:"close_wait-tcp\u5305\u901a\u4fe1\u8bf7\u6c42\u5206\u6790"},"CLOSE_WAIT TCP\u5305\u901a\u4fe1\u8bf7\u6c42\u5206\u6790"),Object(l.b)("p",null,"\u4e09\u6b21\u63e1\u624b\u8bf7\u6c42\u5b8c\u6210:"),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{}),"13:28:14.661683 IP client.45068 > server: Flags [S], seq 2644197498, win 29200, options [mss 1460,sackOK,TS val 451059577 ecr 0,nop,wscale 7], length 0\n13:28:14.809077 IP server > client.45068: Flags [S.], seq 1368176130, ack 2644197499, win 28960, options [mss 1460,sackOK,TS val 521897961 ecr 451059577,nop,wscale 7], length 0\n13:28:14.809088 IP client.45068 > server: Flags [.], ack 1, win 229, options [nop,nop,TS val 451059613 ecr 521897961], length 0\n")),Object(l.b)("p",null,"\u5f00\u59cb\u4f20\u8f93\u6570\u636e:"),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{}),"13:28:14.809124 IP client.45068 > server: Flags [P.], seq 1:702, ack 1, win 229, options [nop,nop,TS val 451059613 ecr 521897961], length 701\n13:28:14.956014 IP server > client.45068: Flags [.], ack 702, win 238, options [nop,nop,TS val 521897998 ecr 451059613], length 0\n\n13:28:14.966435 IP server > client.45068: Flags [P.], seq 1:591, ack 702, win 238, options [nop,nop,TS val 521898000 ecr 451059613], length 590\n13:28:14.966439 IP client.45068 > server: Flags [.], ack 591, win 238, options [nop,nop,TS val 451059653 ecr 521898000], length 0\n")),Object(l.b)("p",null,"\u5f00\u59cb\u91ca\u653e\u8bf7\u6c42\n\u7b2c\u4e00\u6325\u624b"),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{}),"13:29:19.963379 IP server > client.45068: Flags [F.], seq 591, ack 702, win 238, options [nop,nop,TS val 521914250 ecr 451059653], length 0\n")),Object(l.b)("p",null,"\u7b2c\u4e8c\u6b21\u6325\u624b"),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{}),"13:29:20.001642 IP client.45068 > server: Flags [.], ack 592, win 238, options [nop,nop,TS val 451075912 ecr 521914250], length 0\n")),Object(l.b)("p",null,"\u8fd9\u4e2a\u901a\u4fe1\u8bb0\u5f55\u4e2d,\u670d\u52a1\u7aef\u53d1\u8d77\u6325\u624b\u8bf7\u6c42\u65f6\u8fdb\u5165CLOSE_WAIT\u72b6\u6001,\u7b49\u5f85\u5173\u95ed,\u8fd9\u4e2a\u65f6\u5019\u65e0\u6cd5\u5173\u95ed\u5e94\u7528,\u8fdb\u7a0b\u6302\u8d77 "),Object(l.b)("h2",{id:"xmind\u601d\u7ef4\u5bfc\u56fe\u9644\u4ef6\u4e0b\u8f7d"},"xmind\u601d\u7ef4\u5bfc\u56fe\u9644\u4ef6\u4e0b\u8f7d"),Object(l.b)("p",null," ",Object(l.b)("a",Object(c.a)({parentName:"p"},{href:"../static/xmind/TCP%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82.xmind"}),"TCP\u7f51\u7edc\u8bf7\u6c42.xmind")," "))}o.isMDXComponent=!0},139:function(e,t,n){"use strict";n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return u}));var c=n(0),a=n.n(c);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);t&&(c=c.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,c)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t){if(null==e)return{};var n,c,a=function(e,t){if(null==e)return{};var n,c,a={},l=Object.keys(e);for(c=0;c<l.length;c++)n=l[c],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(c=0;c<l.length;c++)n=l[c],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var i=a.a.createContext({}),o=function(e){var t=a.a.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},O=function(e){var t=o(e.components);return a.a.createElement(i.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},j=a.a.forwardRef((function(e,t){var n=e.components,c=e.mdxType,l=e.originalType,p=e.parentName,i=b(e,["components","mdxType","originalType","parentName"]),O=o(n),j=c,u=O["".concat(p,".").concat(j)]||O[j]||s[j]||l;return n?a.a.createElement(u,r(r({ref:t},i),{},{components:n})):a.a.createElement(u,r({ref:t},i))}));function u(e,t){var n=arguments,c=t&&t.mdxType;if("string"==typeof e||c){var l=n.length,p=new Array(l);p[0]=j;var r={};for(var b in t)hasOwnProperty.call(t,b)&&(r[b]=t[b]);r.originalType=e,r.mdxType="string"==typeof e?e:c,p[1]=r;for(var i=2;i<l;i++)p[i]=n[i];return a.a.createElement.apply(null,p)}return a.a.createElement.apply(null,n)}j.displayName="MDXCreateElement"}}]);